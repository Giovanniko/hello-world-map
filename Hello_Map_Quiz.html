<!-- This is the corresponding "starter code" for 04_Hello Map in Udacity and Google's Maps
API Course, Lesson 1 -->
<html>
 <head>
 <!-- styles put here, but you can include a CSS file and reference it instead! -->
   <style type="text/css">
     html, body { height: 100%; margin: 0; padding: 0; }
     #map { height: 100%; }
   </style>
 </head>
 <body>
   <!-- TODO 1: Create a place to put the map in the HTML-->
   <div id="map"></div>
   <script>
   //Create a map variable
    var map;
    //Create array of markers
    var markers = [];
    

     // TODO: Complete the following function to initialize the map
     function initMap() {
       
       map = new google.maps.Map(document.getElementById("map"), {
           center: {lat: 40.740386, lng: -73.920872},
           zoom: 18
       });

       var locations = [
       {title: 'E 72nd Steet, Manhattan', location: {lat: 40.767549, lng: -73.954709}},
       {title: '44th st., Woodside, Queens', location: {lat: 40.740386, lng: -73.920872}},
       {title: '41st st. Sunnyside, Queens', location: {lat: 40.746774, lng: -73.923021}},
       {title: '103rd st. Corona, Queens', location: {lat: 40.74978, lng: -73.862646}},
       {title: '117th st., Queens', location: {lat: 40.758247, lng: -73.862267 }},
       {title: '20 Henry st., Brooklyn Heights, Brooklyn', location: {lat: 40.700203, lng: -73.991933}},
       {title: 'Avenue J, Midwood, Brooklyn', location: {lat: 40.624991, lng: -73.961067}},
       {title: '190 st. & Davidson, Bronx', location: {lat: 40.865379, lng: -73.900579}}
       ];

       var largeInfowindow = new google.maps.InfoWindow();
       var bounds = new google.maps.LatLngBounds();

       //the loop takes the location array and ceates and array of markers on initilizing
       for (var i = 0; i <locations.length; i++) {
           //get postion from the location array
           var position = locations[i].location;
           var title = locations[i].title;
           //create one marker per location and put the in the markers array
           var marker = new google.maps.Marker({
               map: map,
               position: position,
               title: title,
               animation: google.maps.Animation.DROP,
               id:i
           });
           //push each marker on to the markers array
           markers.push(marker);
           //extend the boundaries of the map for each marker
           bounds.extend(marker.position);
           //create an event listener when clicking to open each infowindow
           marker.addListener('click', function() {
               populateInfoWindow(this, largeInfowindow);//this refers to the object to the left of the dot at function scall time
           });
       }
       
       map.fitBounds(bounds);

       //Populate the infowindow when the marker is clicked
       function populateInfoWindow(marker, infowindow) {
           //check to make sure the info window is not already openend on this marker
           if (infowindow.marker != marker) {
               infowindow.marker = marker;
               infowindow.setContent('<div>' + marker.title + '<div>');
               infowindow.open(map, marker);
               
               //Make sure the marker property is cleared if the infowindow is closed
               infowindow.addListener('closeclick', function(){
                   infowindow.setMarker(null);
               });
           }
       }




//        var woodside = {lat: 40.740386, lng: -73.920872};
//        var firstNYC = new google.maps.Marker({
//            position: woodside,
//            map: map,
//            title: "Woodside, Queens"
//        });
//        var infowindow = new google.maps.InfoWindow({
//            content: '47-31 44th Street, Woodside, New York 11377'
//        });

//        firstNYC.addListener('click', function() {
//            infowindow.open(map, firstNYC);//if not 'marker' use a position property so it has a place to open
//        });
     }
   </script>
   <!--TODO: Load the JS API ASYNCHRONOUSLY below.-->
   <script sync defer
    src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyAMrVj6I_6cXo7DF5ienNCjvj1seozxvbU&v=3&callback=initMap">
   </script>
 </body>
</html>
